<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Edit Dish</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  </head>
  <body>
    <header class="topbar">
      <div class="brand">My Kitchen</div>
      <nav><a class="btn" href="{{ url_for('index') }}">Back</a></nav>
    </header>

    <main class="container card">
      <h2>Edit Dish</h2>
      <form action="{{ url_for('edit_dish_route', dish_id=dish['id']) }}" method="post" class="simple-form">
        <label>New name<br><input name="new_name" value="{{ dish['dish_name'] }}" required></label><br>
        <label>Price<br><input name="price" type="number" step="any" value="{{ dish['dish_price'] }}" min="0.01"></label><br>

        <h3>Ingredients (replace existing)</h3>
        <div id="ingredients">
          {% for ing in current_ings %}
            <div class="row">
              <input name="item_name[]" value="{{ ing['ingredient_name'] }}">
              <input name="item_qty[]" value="{{ ing['quantity_needed'] }}" type="number" step="any" min="0.0001">
              <select name="item_unit[]">
                {% for u in units %}<option value="{{ u }}" {% if u==ing['unit'] %}selected{% endif %}>{{ u }}</option>{% endfor %}
              </select>
              <button type="button" onclick="this.parentElement.remove()">Remove</button>
            </div>
          {% endfor %}
        </div>

        <p>
          <button type="button" class="btn" onclick="addRow()">Add ingredient</button>
          <button type="submit" class="btn">Save</button>
        </p>
      </form>
    </main>

    <script>
      function addRow(){
        const div = document.createElement('div');
        div.className = 'row';
        div.innerHTML = '<input name="item_name[]" placeholder="Ingredient name"> ' +
                        '<input name="item_qty[]" placeholder="Quantity needed" type="number" step="any" min="0.0001"> ' +
                        '<select name="item_unit[]">{% for u in units %}<option>{{ u }}</option>{% endfor %}</select> ' +
                        '<button type="button" onclick="this.parentElement.remove()">Remove</button>';
        document.getElementById('ingredients').appendChild(div);
      }
    </script>
  </body>
</html>
